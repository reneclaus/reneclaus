---
title: 'Figure: Logit Evolution Plots'
date: '2024-07-10'
draft: false
discoverable: false
tags: ['llm']
summary: 'An explanation of the logit evolution plots.'
---

## Objective

These plots illustrate how, as the model works through each of its layers, the
prediction score of the next token changes.

They provide insights into:

- Which layers are contributing to the final prediction.
- What the relative importance of the attention and feed forward networks are.
- If there are qualitative differences between different tokens.

## Example

This example is for the following example text. The current tokens is "citizens"
and the next token in the original text is a comma (,). We examine two plots:

1. Score Plot: the y-axis plots the next-token prediction score for the token
   named on the x-axis.
2. Rank Plot: the y-axis plots how many other tokens scored higher than the
   token for each line.

The tokens studied are the highest scoring tokens if the entire model is
evaluated. In the score plot, the tokens are ordered along the x-axis by their
score when using the full model--so the most likely next token prediction is on
the left.

Each of the lines is stripped with dark and light portions. The light segments
are the effect of the attention block while the dark segments are the effect of
the feed forward network.

---

> Community Involvement. Kraemer Mining & Materials is committed to being a strong
> community partner by working with <u>citizens</u>, ...

<PlotlyChart src="/blog/llm-research/figures/logit_evolution_3_21.json" />
<PlotlyChart src="/blog/llm-research/figures/rank_ordering_evolution_3_21.json" />

We might also wonder how the prediction score values of the top-10 compare to
all the other tokens. The next figure shows a histogram of the normalized
prediction scores of all the possible output tokens. The scores along the x-axis
have been normalized to have `mean = 0` and `std = 1` so that the histograms are
easier to compare layer-to-layer. The slider below the plot lets you select the
point in the model to look at. The top-10 values shown above are emphasized in
light blue so you can see how they move within the overall distribution. If you
hover over the figure you can get a few samples of tokens that fall within that
bin. The figure is shown on a log scale to make the top-10 samples visible.

<PlotlyChart src="/blog/llm-research/figures/histogram_of_logits_3_21.json" />

## Notes

Since the next-token prediction score is passed through a `softmax`, a constant
value can be added to all scores without affecting the result.
